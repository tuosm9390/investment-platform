export interface GlossaryEntry {
  term: string;
  shortDesc: string;
  detail: string;
  easyMode: string; // 쉬운 말 모드 대체 텍스트
  metaphor?: string; // 🐋 고래 비유 (초보자 친화)
  actionTip?: string; // 실전 팁
}

// ─────────────────────────────────────────────
// 투자 전문 용어 사전 (SMC/ICT 트레이닝 프롬프트 기반)
// ─────────────────────────────────────────────
export const GLOSSARY: Record<string, GlossaryEntry> = {

  // ═══════════════════════════════════════════
  // 📈 기술 지표
  // ═══════════════════════════════════════════
  RSI: {
    term: 'RSI (상대강도지수)',
    shortDesc: '가격이 너무 올랐는지, 너무 떨어졌는지 알려주는 온도계',
    detail: '0~100 사이의 값을 가집니다. 70 이상이면 "과열(너무 올랐다)", 30 이하면 "빙하(너무 떨어졌다)"로 해석합니다.',
    easyMode: '가격 온도계',
    metaphor: '🐋 고래들은 RSI가 30 이하로 떨어진 "공포" 구간에서 조용히 매수합니다. 반대로 70 이상 "탐욕" 구간에서 개인 투자자(물고기)에게 비싸게 팔아요.',
    actionTip: 'RSI 30 이하에서 매수 기회를 탐색하고, 70 이상에서는 욕심 부리지 마세요.',
  },
  MACD: {
    term: 'MACD (이동평균수렴확산)',
    shortDesc: '추세의 방향과 힘이 바뀌는 순간을 포착하는 신호등',
    detail: '두 개의 평균선 차이를 비교합니다. MACD 선이 신호선을 위로 교차하면 "파란불(매수)", 아래로 교차하면 "빨간불(매도)"로 봅니다.',
    easyMode: '추세 신호등',
    metaphor: '🐋 고래는 MACD 히스토그램이 점점 작아지다가 반전하는 순간, 즉 "힘이 빠지는 타이밍"을 노립니다.',
    actionTip: 'MACD 교차만 보지 말고, 히스토그램의 크기 변화도 함께 보세요.',
  },
  EMA: {
    term: 'EMA (지수이동평균)',
    shortDesc: '최근 가격에 더 민감하게 반응하는 평균 가격선',
    detail: 'EMA 20은 "단기 흐름", EMA 50은 "중기 흐름"을 보여줍니다. 가격이 EMA 위에 있으면 상승 추세, 아래에 있으면 하락 추세입니다.',
    easyMode: '평균 가격선',
    metaphor: '🐋 고래는 가격이 EMA 50 근처로 내려올 때 "할인 매수"를 합니다. 개인 투자자는 이미 올라간 가격을 쫓아가요.',
    actionTip: 'EMA 20과 50이 겹치는 구간은 추세 변화의 신호일 수 있어요.',
  },
  CONFIDENCE: {
    term: '신뢰도 (Confidence)',
    shortDesc: 'AI가 자신의 분석을 얼마나 확신하는지 보여주는 수치',
    detail: '0%~100% 범위입니다. 높을수록 여러 지표가 같은 방향을 가리키고 있다는 뜻이지만, 100%라도 미래를 보장하지는 않습니다.',
    easyMode: 'AI 확신도',
    actionTip: '70% 이상이면 참고 가치가 있고, 50% 미만이면 시장이 혼조세라는 뜻입니다.',
  },

  // ═══════════════════════════════════════════
  // 🐋 SMC/ICT 핵심 개념 — "고래의 발자국 찾기"
  // ═══════════════════════════════════════════
  FVG: {
    term: 'FVG (공정가치 갭)',
    shortDesc: '고래가 너무 빠르게 움직여서 남긴 "구멍" — 가격이 돌아와 채우려 함',
    detail: '3개의 연속 캔들에서 1번째 캔들의 고점과 3번째 캔들의 저점 사이에 겹침이 없는 빈 공간입니다.',
    easyMode: '가격 빈 공간',
    metaphor: '🐋 고래가 수영장에서 너무 세게 점프하면 물이 튀어서 빈 공간이 생기죠? 시장도 마찬가지예요. 급등/급락 후 생긴 "빈 공간"은 자연이 구멍을 싫어하듯 다시 채워지려고 합니다.',
    actionTip: '가격을 쫓아가지 마세요. FVG(빈 공간)로 돌아올 때까지 기다리세요 — 그것이 입장권입니다.',
  },
  OB: {
    term: 'OB (오더블록)',
    shortDesc: '고래가 대량 매수/매도한 "발자국" — 가격이 여기로 돌아오면 반응할 확률 높음',
    detail: '큰 가격 움직임 직전의 마지막 반대 방향 캔들입니다. 급등 직전의 마지막 음봉이 매수 OB, 급락 직전의 마지막 양봉이 매도 OB입니다.',
    easyMode: '고래 매매 구간',
    metaphor: '🐋 고래는 너무 무거워서 수영장에 뛰어들면 엄청난 물보라가 생깁니다. 그 "물보라"가 바로 오더블록이에요. 가격이 이 자리로 돌아오면 고래가 다시 방어합니다.',
    actionTip: '오더블록 + FVG가 겹치는 구간은 가장 확률 높은 진입 기회입니다.',
  },
  BOS: {
    term: 'BOS (구조 이탈)',
    shortDesc: '이전 고점/저점을 돌파 — "추세가 계속된다"는 확인 신호',
    detail: 'Break of Structure. 상승 추세에서 이전 고점을 넘으면 상승 BOS, 하락 추세에서 이전 저점을 깨면 하락 BOS입니다.',
    easyMode: '추세 지속 확인',
    metaphor: '🐋 고래가 헤엄치는 방향을 확인하는 것! 이전보다 더 높이 올라가면 "아직 위로 가고 있다"는 뜻이에요.',
    actionTip: 'BOS는 추세의 "지속"을 의미합니다. 반전과 헷갈리지 마세요.',
  },
  CHOCH: {
    term: 'CHoCH (추세 전환)',
    shortDesc: '고래가 방향을 바꿨다! 상승→하락 또는 하락→상승 전환 신호',
    detail: 'Change of Character. 상승 추세에서 처음으로 이전 저점을 깨면 하락 전환, 하락 추세에서 처음으로 이전 고점을 넘으면 상승 전환 신호입니다.',
    easyMode: '추세 반전 신호',
    metaphor: '🐋 고래가 갑자기 U턴한 거예요! 지금까지 위로 헤엄치다가 처음으로 아래로 꺾이면, "앗, 방향 바뀌었다!"하고 알아차려야 합니다.',
    actionTip: 'CHoCH가 나타나면 기존 포지션을 점검하세요. 추세가 바뀌는 첫 신호입니다.',
  },
  MSS: {
    term: 'MSS (시장 구조 전환)',
    shortDesc: 'CHoCH와 동일 — 기존 추세가 반대로 바뀌는 첫 번째 신호',
    detail: 'Market Structure Shift. CHoCH(Change of Character)와 같은 개념으로, 추세 전환의 시작을 알립니다.',
    easyMode: '추세 전환 신호',
    metaphor: '🐋 고래가 수면 위로 점프하다가 갑자기 깊은 곳으로 잠수하기 시작했어요. 수영 방향이 완전히 바뀐 거죠!',
  },
  LIQUIDITY: {
    term: '유동성 (Liquidity)',
    shortDesc: '고래의 "연료" — 개인 투자자들의 손절 주문이 모여 있는 곳',
    detail: '수많은 투자자의 손절(Stop Loss) 주문이 집중된 가격대입니다. 전통 분석에서는 "지지/저항"이지만, SMC에서는 고래가 먹을 "연료"가 있는 곳으로 봅니다.',
    easyMode: '큰손의 연료',
    metaphor: '🐋 핵심 통찰: 전통적 분석에서 "쌍바닥(더블 바텀)"은 지지선이지만, SMC에서는 "사탕 가게"입니다! 그 아래에 개인 투자자들의 돈(손절 주문)이 있고, 고래는 이걸 먹으러 가격을 깨뜨린 뒤 진짜 방향으로 움직여요.',
    actionTip: '모두가 손절을 놓는 자리(뻔한 고점/저점)를 파악하세요. 고래가 그 연료를 먹은 "후"에 진입하는 것이 핵심입니다.',
  },
  LIQUIDITY_SWEEP: {
    term: '유동성 스윕 (Liquidity Sweep)',
    shortDesc: '고래가 개인 투자자의 손절을 일부러 건드린 뒤 반대로 움직이는 전략',
    detail: '개인 투자자들의 손절 주문이 모인 가격대를 일시적으로 건드려 유동성을 확보한 후, 원래 의도한 방향으로 이동하는 패턴입니다.',
    easyMode: '큰손의 함정',
    metaphor: '🐋 내가 안전하다고 생각한 순간, 고래가 가격을 떨어뜨려 손절을 터트립니다. 당신의 "연료"를 훔쳐서 진짜 방향으로 로켓을 발사하는 거예요!',
    actionTip: '스윕이 일어난 "후"에 진입하세요. 스윕 전에 들어가면 당신이 연료가 됩니다.',
  },
  INDUCEMENT: {
    term: '유인 (Inducement)',
    shortDesc: '고래가 설치한 "미끼" — 가격이 올라가는 것처럼 속여서 매수를 유도',
    detail: '가격이 뚜렷하게 상승/하락하는 것처럼 보이게 만들어 개인 투자자를 잘못된 방향으로 유인하는 패턴입니다.',
    easyMode: '큰손의 미끼',
    metaphor: '🐋 고래가 가격을 올리는 "척"합니다. "와, 오른다!" 하고 뛰어드는 물고기(개인 투자자)를 한꺼번에 잡기 위한 덫이에요.',
    actionTip: '패턴이 "너무 뻔하게" 보이면 경계하세요. 모두에게 보이는 셋업은 십중팔구 함정입니다.',
  },

  // ═══════════════════════════════════════════
  // ⏰ 시간 이론 — "고래의 식사 시간"
  // ═══════════════════════════════════════════
  KILL_ZONE: {
    term: '킬 존 (Kill Zone)',
    shortDesc: '고래가 활발하게 움직이는 특정 시간대 — 이때만 거래하세요!',
    detail: '⚡ 핵심 통찰: "가격보다 시간이 중요합니다." 완벽한 패턴이라도 잘못된 시간에 나타나면 함정입니다.',
    easyMode: '핵심 거래 시간',
    metaphor: '🐋 고래는 하루 종일 사냥하지 않아요. 특정 시간에만 배고프죠.\n• 🇬🇧 런던 아침 (한국 18시~21시): 유럽 시장 개장\n• 🇺🇸 뉴욕 점심 (한국 23시~02시): 미국 시장 활발\n고래가 자고 있을 때는 우리도 쉬어야 합니다.',
    actionTip: '킬존 밖에서는 차트를 보지 마세요. 불필요한 거래를 줄이는 것이 수익의 핵심입니다.',
  },
  SILVER_BULLET: {
    term: '실버 불릿 (Silver Bullet)',
    shortDesc: '킬존 내 딱 1시간 동안만 나타나는 고확률 알고리즘 셋업',
    detail: '뉴욕 시간 오전 10시~11시(한국 자정~새벽 1시) 사이에 나타나는 특정 패턴입니다. 하루 종일 차트를 볼 필요 없이, 이 1시간만 집중하면 됩니다.',
    easyMode: '1시간 집중 타이밍',
    metaphor: '🐋 고래들의 "정찬 시간"이에요. 이 60분 안에 가장 깨끗하고 확실한 움직임이 나옵니다.',
  },

  // ═══════════════════════════════════════════
  // 🎭 시장 시나리오 — "시장은 각본이 있다"
  // ═══════════════════════════════════════════
  AMD: {
    term: 'AMD (축적→조작→분배)',
    shortDesc: '모든 캔들은 각본에 따라 움직인다: 모으기 → 속이기 → 나누기',
    detail: '⚡ 핵심 통찰: 시장의 모든 움직임에는 3단계 시나리오가 있습니다.\n① Accumulation(축적): 고래가 지루한 횡보장에서 조용히 주문을 쌓습니다.\n② Manipulation(조작/유다스 스윙): 세션 시작 시 반대 방향으로 "가짜 움직임"을 만들어 물고기를 덫에 빠뜨립니다.\n③ Distribution(분배): 덫이 설치된 후 진짜 방향으로 대규모 이동이 일어납니다.',
    easyMode: '모으기→속이기→진짜 움직임',
    metaphor: '🐋 고래의 완벽한 작전!\n1️⃣ 조용히 모은다 (지루한 횡보)\n2️⃣ 반대로 속인다 (급등 또는 급락 "척")\n3️⃣ 진짜 방향으로 간다 (대폭등 또는 대폭락)',
    actionTip: '런던/뉴욕 오픈 직후의 첫 움직임은 대부분 "속임수(조작)"입니다. 첫 움직임에 뛰어들지 마세요.',
  },
  UNICORN: {
    term: '유니콘 모델 (Unicorn Model)',
    shortDesc: 'Breaker Block + FVG가 겹치는 최고 확률 셋업 — 이름처럼 희귀하지만 강력함',
    detail: '실패한 오더블록(Breaker Block)과 FVG(공정가치 갭)가 같은 가격대에서 겹칠 때 발생합니다. 기관이 특정 가격대를 사수하려는 "절박함"이 반영된 신호입니다.',
    easyMode: '최고 확률 신호',
    metaphor: '🐋 고래가 "여기서 반드시 지킨다!"라고 두 번이나 표시한 자리예요. 두 개의 발자국이 겹치면 신뢰도가 크게 올라갑니다.',
    actionTip: '유니콘 모델은 드물게 나타나지만 나타나면 높은 확률로 작동합니다. 인내심을 가지세요.',
  },
  JUDAS_SWING: {
    term: '유다스 스윙 (Judas Swing)',
    shortDesc: '세션 시작 시 진짜 방향과 반대로 움직이는 "배신의 가짜 움직임"',
    detail: 'AMD(축적→조작→분배)의 조작(Manipulation) 단계에서 나타납니다. 런던이나 뉴욕 세션이 열릴 때 반대 방향으로 가격을 움직여 물고기를 함정에 빠뜨립니다.',
    easyMode: '가짜 첫 움직임',
    metaphor: '🐋 영화에서 배신자 유다처럼, 시장이 "이쪽이야!" 하고 손짓하지만 실제로는 반대 방향으로 갑니다. 세션 오픈 직후 첫 움직임을 믿지 마세요!',
    actionTip: '구조 분석(BOS/CHoCH)과 함께 확인 후 진입하세요.',
  },
  BREAKER_BLOCK: {
    term: 'Breaker Block (브레이커 블록)',
    shortDesc: '한번 실패한(뚫린) 오더블록이 역할이 반전된 강력한 구간',
    detail: '원래 지지/저항 역할을 하던 오더블록이 한번 뚫린 후, 반대 역할(지지↔저항)로 전환된 구간입니다. "실패했기에 더 강하다"는 역설적 개념입니다.',
    easyMode: '뒤집힌 큰손 구간',
    metaphor: '🐋 고래가 처음엔 이 구간을 지키려 했지만 실패했어요. 이제 이 구간은 "반대편의 방벽"이 됩니다.',
  },

  // ═══════════════════════════════════════════
  // 💰 매매 용어
  // ═══════════════════════════════════════════
  ENTRY: {
    term: '진입가 (Entry Price)',
    shortDesc: '매수 또는 매도 주문을 넣을 가격',
    detail: 'AI가 이 가격에서 포지션에 진입하는 것을 권장합니다.',
    easyMode: '매수 예정 가격',
    metaphor: '🐋 고래의 발자국(OB)이나 빈 공간(FVG) 근처에서 진입하는 것이 핵심! 가격을 쫓아가지 말고 "돌아올 때까지" 기다리세요.',
    actionTip: '진입 전 반드시 손절가를 먼저 설정하세요.',
  },
  TARGET: {
    term: '목표가 (Target Price)',
    shortDesc: '수익을 실현할 예상 도달 가격',
    detail: '분석에 따라 가격이 도달할 것으로 예상되는 수준입니다. 이 가격에 도달하면 수익을 확정(익절)하는 것이 권장됩니다.',
    easyMode: '목표 수익 가격',
    actionTip: '목표가에 100% 도달하길 기다리지 말고, 70~80% 지점에서 일부 익절하는 "분할 매도"를 추천합니다.',
  },
  STOP_LOSS: {
    term: '손절가 (Stop Loss)',
    shortDesc: '손실을 제한하는 안전장치 — 이 가격에 도달하면 자동 매도',
    detail: '예측과 반대로 가격이 움직일 때, 더 큰 손실을 방지하기 위해 미리 설정하는 안전장치입니다.',
    easyMode: '손실 제한 가격',
    metaphor: '🐋 주의: 고래는 뻔한 곳(직전 고점/저점)에 놓인 손절을 "연료"로 삼아요. 손절을 너무 뻔한 자리에 놓지 마세요. 오더블록의 뒤쪽(약간 여유를 둔 곳)에 놓는 것이 안전합니다.',
    actionTip: '절대 손절 없이 거래하지 마세요. 한 번의 큰 손실이 10번의 수익을 날릴 수 있습니다.',
  },

  // ═══════════════════════════════════════════
  // 📊 추세 방향
  // ═══════════════════════════════════════════
  BULLISH: {
    term: '상승 추세 (Bullish)',
    shortDesc: '가격이 올라갈 것으로 예상 — 황소가 뿔로 위를 찌르는 모습에서 유래',
    detail: '매수 우위의 시장으로, 가격 상승이 기대됩니다. 고점과 저점이 모두 높아지는 구조입니다.',
    easyMode: '오름세 📈',
    metaphor: '🐋 고래가 위를 향해 헤엄치고 있어요. 물 위로 더 높이 점프하고 있는 구조입니다.',
  },
  BEARISH: {
    term: '하락 추세 (Bearish)',
    shortDesc: '가격이 내려갈 것으로 예상 — 곰이 아래를 내리치는 모습에서 유래',
    detail: '매도 우위의 시장으로, 가격 하락이 예상됩니다. 고점과 저점이 모두 낮아지는 구조입니다.',
    easyMode: '내림세 📉',
    metaphor: '🐋 고래가 깊은 곳으로 잠수하고 있어요. 점점 더 깊이 내려가는 구조입니다.',
  },
  NEUTRAL: {
    term: '중립 (Neutral)',
    shortDesc: '뚜렷한 방향 없이 횡보하는 상태 — 관망 추천',
    detail: '매수/매도 어느 쪽이든 우세하지 않으며, 관망이 권장되는 상태입니다.',
    easyMode: '횡보 ↔️',
    metaphor: '🐋 고래가 조용히 쉬고 있어요. 이때는 AMD의 "축적(Accumulation)" 단계일 수 있으니, 곧 큰 움직임이 올 수 있습니다.',
  },
  CHOPPY: {
    term: '혼조세 (Choppy)',
    shortDesc: '방향 없이 위아래로 불규칙하게 움직이는 위험한 상태',
    detail: '추세가 불분명하여 매매 진입이 어려운 상태입니다.',
    easyMode: '불규칙 ⚡',
    metaphor: '🐋 바다가 폭풍이에요. 고래도 물고기도 방향을 잡을 수 없습니다. 이런 날은 차트를 끄세요!',
    actionTip: '혼조세에서 무리하게 거래하면 양방향으로 손절이 됩니다. 인내심이 최고의 전략입니다.',
  },

  // ═══════════════════════════════════════════
  // 🚦 매매 신호
  // ═══════════════════════════════════════════
  STRONG_BUY: {
    term: '강력 매수 (Strong Buy)',
    shortDesc: '여러 지표가 매수 방향으로 강하게 일치하는 최고 등급 신호',
    detail: '기술 지표, 시장 구조, AI 분석이 모두 매수를 지지할 때 발생합니다. 그러나 절대적인 것이 아니며 항상 리스크 관리가 필요합니다.',
    easyMode: '✅ 매수 추천 (강)',
    actionTip: '강력 매수라도 전 자산을 투입하지 마세요. 감당 가능한 금액만 사용하세요.',
  },
  BUY: {
    term: '매수 (Buy)',
    shortDesc: '매수에 유리한 조건이 갖춰진 신호',
    detail: '매수 조건이 충분히 갖춰졌으나 강력 매수보다는 확신이 조금 낮은 상태입니다.',
    easyMode: '✅ 매수 고려',
  },
  HOLD: {
    term: '관망 (Hold)',
    shortDesc: '새로운 진입 없이 현재 상태를 유지 — 지켜보기',
    detail: '지표가 혼재되어 있어 뚜렷한 방향성이 부족합니다.',
    easyMode: '⏸️ 지켜보기',
    metaphor: '🐋 고래가 아직 방향을 정하지 않았어요. 가만히 기다리세요.',
  },
  SELL: {
    term: '매도 (Sell)',
    shortDesc: '보유 자산 매도 또는 숏 포지션을 고려할 신호',
    detail: '하락 가능성이 감지되어 수익 실현 또는 손실 제한 차원에서 매도가 권장됩니다.',
    easyMode: '🔻 매도 고려',
  },
  STRONG_SELL: {
    term: '강력 매도 (Strong Sell)',
    shortDesc: '여러 지표가 매도 방향으로 강하게 일치하는 신호',
    detail: '하락 리스크가 매우 높다고 판단됩니다.',
    easyMode: '🔻 매도 추천 (강)',
  },
  NO_TRADE: {
    term: '거래 금지 (No Trade)',
    shortDesc: '시장이 위험하여 거래를 자제해야 하는 상태',
    detail: '시장 방향성이 불분명하거나 변동성이 극심하여 어떤 방향으로든 진입이 위험합니다.',
    easyMode: '⛔ 거래 자제',
    metaphor: '🐋 폭풍우가 치는 바다에 뛰어드는 물고기는 없어요. 살아 있어야 내일 거래할 수 있습니다.',
  },
};

// ─────────────────────────────────────────────
// 유틸리티 함수
// ─────────────────────────────────────────────

/** 추천 텍스트를 쉬운 말로 변환 */
export function getEasyRecommendation(recommendation: string): string {
  const key = recommendation.toUpperCase().replace(/\s+/g, '_');
  return GLOSSARY[key]?.easyMode || recommendation;
}

/** 추세 텍스트를 쉬운 말로 변환 */
export function getEasyTrend(trend: string): string {
  const key = trend.toUpperCase();
  return GLOSSARY[key]?.easyMode || trend;
}

/** 용어 검색 */
export function findGlossaryEntry(term: string): GlossaryEntry | undefined {
  const normalizedTerm = term.toUpperCase().replace(/\s+/g, '_');
  return GLOSSARY[normalizedTerm];
}

/** metaphor(고래 비유)가 있으면 반환, 없으면 detail 반환 */
export function getBeginnerExplanation(key: string): string {
  const entry = GLOSSARY[key.toUpperCase().replace(/\s+/g, '_')];
  if (!entry) return '';
  return entry.metaphor || entry.detail;
}
